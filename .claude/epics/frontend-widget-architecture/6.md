---
title: "AI äº¤äº’ç•Œé¢"
epic: "frontend-widget-architecture"
number: 5
batch: 2
status: "pending"
priority: "high"
estimated_hours: 14
tags: ["ai", "chat", "vercel-ai-sdk", "messages"]
parallel: false
depends_on: [1, 2, 3]
assigned_to: ""
reviewer: ""
created_at: "2025-10-07T05:19:46Z"
updated_at: "2025-10-07T05:19:46Z"
---

## ğŸ“‹ ä»»åŠ¡æ¦‚è¿°

é›†æˆ Vercel AI SDKï¼Œå®ç°å®Œæ•´çš„ AI èŠå¤©äº¤äº’ç•Œé¢ï¼ŒåŒ…æ‹¬æ¶ˆæ¯ç»„ä»¶ã€è¾“å…¥æ¡†ã€æ‰“å­—åŠ¨ç”»ã€æµå¼å“åº”ç­‰æ ¸å¿ƒèŠå¤©åŠŸèƒ½ã€‚

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### æ ¸å¿ƒè¦æ±‚
- [ ] é›†æˆ Vercel AI SDKï¼Œæ”¯æŒæµå¼å¯¹è¯å“åº”
- [ ] å®ç°å®Œæ•´çš„èŠå¤©ç•Œé¢ç»„ä»¶ï¼ˆæ¶ˆæ¯åˆ—è¡¨ã€è¾“å…¥æ¡†ã€å‘é€æŒ‰é’®ï¼‰
- [ ] æ”¯æŒæ‰“å­—åŠ¨ç”»å’Œæ¶ˆæ¯æµå¼æ˜¾ç¤º
- [ ] æ¶ˆæ¯çŠ¶æ€ç®¡ç†ï¼ˆå‘é€ä¸­ã€æˆåŠŸã€å¤±è´¥ã€é‡è¯•ï¼‰
- [ ] æ”¯æŒæ¶ˆæ¯æ ¼å¼åŒ–ï¼ˆä»£ç é«˜äº®ã€é“¾æ¥è§£æã€Markdownï¼‰

### æŠ€æœ¯æ ‡å‡†
- [ ] å®æ—¶æµå¼å“åº”ï¼Œç”¨æˆ·ä½“éªŒæµç•…
- [ ] æ¶ˆæ¯çŠ¶æ€åŒæ­¥å‡†ç¡®ï¼Œæ— æ•°æ®ä¸¢å¤±
- [ ] æ”¯æŒé•¿å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
- [ ] è¾“å…¥ä½“éªŒä¼˜åŒ–ï¼ˆå¿«æ·é”®ã€è‡ªåŠ¨è°ƒæ•´é«˜åº¦ç­‰ï¼‰

## ğŸ“ è¯¦ç»†ä»»åŠ¡

### 5.1 Vercel AI SDK é›†æˆ (4å°æ—¶)
- å®‰è£…å’Œé…ç½® Vercel AI SDK ç›¸å…³ä¾èµ–
- å®ç°ä¸åç«¯ AI æœåŠ¡çš„ WebSocket è¿æ¥
- é…ç½®æµå¼å“åº”å¤„ç†å’Œé”™è¯¯å¤„ç†æœºåˆ¶
- å»ºç«‹ AI ä¼šè¯çŠ¶æ€ç®¡ç†

### 5.2 èŠå¤©ç•Œé¢æ ¸å¿ƒç»„ä»¶ (5å°æ—¶)
- åˆ›å»º `ChatInterface` ä¸»å®¹å™¨ç»„ä»¶
- å®ç° `MessageList` æ¶ˆæ¯åˆ—è¡¨ç»„ä»¶ï¼Œæ”¯æŒè™šæ‹Ÿæ»šåŠ¨
- åˆ›å»º `MessageBubble` æ¶ˆæ¯æ°”æ³¡ç»„ä»¶ï¼ŒåŒºåˆ†ç”¨æˆ·å’Œ AI æ¶ˆæ¯
- å®ç° `MessageInput` è¾“å…¥æ¡†ç»„ä»¶ï¼Œæ”¯æŒå¤šè¡Œè¾“å…¥å’Œå¿«æ·æ“ä½œ

### 5.3 æ¶ˆæ¯æ˜¾ç¤ºå’ŒåŠ¨ç”» (3å°æ—¶)
- å®ç°æ‰“å­—åŠ¨ç”»æ•ˆæœå’Œå­—ç¬¦é€å­—æ˜¾ç¤º
- æ·»åŠ æ¶ˆæ¯è¿›å…¥/ç¦»å¼€çš„è¿‡æ¸¡åŠ¨ç”»
- æ”¯æŒæ¶ˆæ¯çŠ¶æ€æŒ‡ç¤ºå™¨ï¼ˆåŠ è½½ä¸­ã€é”™è¯¯ç­‰ï¼‰
- å®ç°æ¶ˆæ¯é‡è¯•å’Œé‡æ–°ç”ŸæˆåŠŸèƒ½

### 5.4 æ¶ˆæ¯æ ¼å¼åŒ–å’Œå¯Œæ–‡æœ¬æ”¯æŒ (2å°æ—¶)
- é›†æˆ Markdown è§£æå’Œæ¸²æŸ“
- å®ç°ä»£ç å—è¯­æ³•é«˜äº®
- æ”¯æŒé“¾æ¥ã€è¡¨æƒ…ç¬¦å·ç­‰å¯Œæ–‡æœ¬å†…å®¹
- æ·»åŠ æ¶ˆæ¯å¤åˆ¶ã€åˆ†äº«ç­‰äº¤äº’åŠŸèƒ½

## ğŸ”§ æŠ€æœ¯è¦æ±‚

### Vercel AI SDK é…ç½®
```typescript
import { useChat } from 'ai/react';

const {
  messages,
  input,
  handleInputChange,
  handleSubmit,
  isLoading,
  error,
  reload,
  stop
} = useChat({
  api: '/api/chat',
  onResponse: (response) => {
    // å¤„ç†æµå¼å“åº”
  },
  onFinish: (message) => {
    // æ¶ˆæ¯å®Œæˆå›è°ƒ
  },
  onError: (error) => {
    // é”™è¯¯å¤„ç†
  }
});
```

### æ¶ˆæ¯æ•°æ®ç»“æ„
```typescript
interface Message {
  id: string;
  role: 'user' | 'assistant' | 'system';
  content: string;
  timestamp: Date;
  status?: 'sending' | 'sent' | 'error' | 'typing';
  metadata?: {
    model?: string;
    tokens?: number;
    duration?: number;
  };
}

interface ChatState {
  messages: Message[];
  isLoading: boolean;
  error: string | null;
  canRetry: boolean;
  context?: ConversationContext;
}
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx
â”‚   â”‚   â”œâ”€â”€ MessageList.tsx
â”‚   â”‚   â”œâ”€â”€ MessageBubble.tsx
â”‚   â”‚   â”œâ”€â”€ MessageInput.tsx
â”‚   â”‚   â”œâ”€â”€ TypingIndicator.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ message/
â”‚   â”‚   â”œâ”€â”€ MessageContent.tsx
â”‚   â”‚   â”œâ”€â”€ MarkdownRenderer.tsx
â”‚   â”‚   â”œâ”€â”€ CodeHighlight.tsx
â”‚   â”‚   â”œâ”€â”€ MessageActions.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ ai/
â”‚       â”œâ”€â”€ AIProvider.tsx
â”‚       â”œâ”€â”€ useAIChat.ts
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useChat.ts
â”‚   â”œâ”€â”€ useMessageInput.ts
â”‚   â””â”€â”€ useTypingAnimation.ts
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ aiService.ts
â”‚   â””â”€â”€ streamingService.ts
â””â”€â”€ types/
    â”œâ”€â”€ chat.ts
    â””â”€â”€ message.ts
```

## âœ… æµ‹è¯•è¦æ±‚

- [ ] AI å“åº”æµå¼æ˜¾ç¤ºæ­£å¸¸ï¼Œæ— å¡é¡¿
- [ ] æ¶ˆæ¯å‘é€å’Œæ¥æ”¶åŠŸèƒ½å®Œæ•´
- [ ] è¾“å…¥æ¡†äº¤äº’ä½“éªŒè‰¯å¥½
- [ ] æ¶ˆæ¯æ ¼å¼åŒ–æ¸²æŸ“æ­£ç¡®
- [ ] é”™è¯¯çŠ¶æ€å¤„ç†å’Œé‡è¯•åŠŸèƒ½æ­£å¸¸
- [ ] é•¿å¯¹è¯æ€§èƒ½è‰¯å¥½ï¼Œæ— å¡é¡¿

## ğŸš€ äº¤ä»˜ç‰©

- [ ] å®Œæ•´çš„èŠå¤©ç•Œé¢ç»„ä»¶åº“
- [ ] Vercel AI SDK é›†æˆå’Œé…ç½®
- [ ] æ¶ˆæ¯çŠ¶æ€ç®¡ç†ç³»ç»Ÿ
- [ ] å¯Œæ–‡æœ¬æ¸²æŸ“ç»„ä»¶
- [ ] èŠå¤©äº¤äº’ä½¿ç”¨æ–‡æ¡£

## ğŸ“š å‚è€ƒèµ„æ–™

- [Vercel AI SDK æ–‡æ¡£](https://sdk.vercel.ai/docs)
- [React Hook Form æ–‡æ¡£](https://react-hook-form.com/)
- [React Markdown æ–‡æ¡£](https://github.com/remarkjs/react-markdown)
- [Prism.js ä»£ç é«˜äº®](https://prismjs.com/)
- [React Spring åŠ¨ç”»åº“](https://www.react-spring.dev/)
